Structure Overview
==================
 
The structure of the FFRM comprises **eight core mathematical equations** used to determine the foregone net revenue of fossil fuel fleets. This is analysed under two regimes: the **PPA** regime, which is based on commercially negotiated power purchase agreements or the **market-based** regime, which reflects projected hourly spot prices that are determined exogenously.

**Equation 1**

The equation is calculating fleetwide net revenue either for the **market regime** (projected hourly spot prices are exogenously inputted into the model) or a **commercial power purchasing agreement**.

- The first part of the equation represents the revenue subtracted by variable cost. This is where electricity price at given year **(y)**, price **(p)** and time **(t)** is subtracted from variable cost of the generator in year **(y)**. Then this is then multiplied by electricity generated.
- The second part of the equation represents fixed cost multiped by retired capacity. This total is subtracted from the first part of the equation.         

Therefore the difference in the **systemwide net revenue** between the business-as-usual scenario and the decarbonisation scenario would be used to calculate the **foregone revenue**. Retired capacity can use the foregone revenue as a calculation of **stranded cost**.  

.. code-block:: ampl

    NR = sum {y, g, t, s, p} (P[y,p,t] - Cost[g,y]) * Gen[g,y,t,s,p]
         - sum {y, g, t, s, p} FC[g,y] * (Capacity[g] - RetireC[g,y,s,p]);

**Equation 2**

This equation is defined as a fraction that sets a limit on how far a generating power plant's unit net revenue can deviate from the business-as-usual scenario. So the fraction illustrates **the proportional loss in net revenue**.   
On the numerator, we have the net revenue for a unit **(g)** under the decarbonisation scenario subtracted from the net revenue from the business-as-usual scenario, with the net revenue from the business-as-usual scenario on the denominator. 
A user defined threshold represent alpha. A constraint is set in the model whereby a **loss in net revenue cannot exceed alpha.**

   

.. code-block:: ampl

    (NR_prime[g,s_prime,p_prime] - NR[g,s,p]) / NR_prime[g,s_prime,p_prime] <= alpha

**Equation 3**

This equation sets a constraint, which requires the fleetwide generation to follow a trajectory defined by the user. It shows that the sum of electricity generated by all units **(g)** over all time blocks **(t)** multiplied by the hours in each time block **H[t]** must be **equal to the system target generation** for that year and specified scenario.  


Under a decarbonisation trajectory, it is assumed that fossil fuel generation will reduce over the years. As a result, the net revenue under a decarbonisation scenario will be **reduced** relative the business-as-usual scenario. **Equation 2** which defines the loss in net revenue will drive the generation allocation.  


.. code-block:: ampl

    sum {t, g} Gen[g,y,t,s,p] * H[t] = Target[y,s,p]

**Equation 4**

This equation shows a constraint whereby the electricity generated per generator **(g)**, in year **(y)**, time period **(t)**,scenario **(s)** and price regime **(p)**, multiped by the number of hours in that period should be **equal to or be greater than** minimum generation of that generator **(g)**.  

.. code-block:: ampl

    sum {t} Gen[g,y,t,s,p] * H[t] >= MinGen[g]

**Equation 5**
This equation is similar to **Equation 4**. However it represents the upper bound whereby the total electricity generation by a generator **(g)** over time **(t)**, scenario **(s)**, price regime **(p)** multiplied by the number of hours in a time period **does not exceed** the specified maximum allowed generation for a generator **(g)**. 

.. code-block:: ampl

    sum {t} Gen[g,y,t,s,p] * H[t] <= MaxGen[g]

**Equation 6**

This equation **tracks generation capacity over time** decreasing capacity when units a retired. Therefore the avaliable capacity is equal to the capacity from the previous year minus any capacity that is retired in year **(y)**.   

.. code-block:: ampl

    Cap[g,y,s,p] = Cap[g,y-1,s,p] - Retire[g,y,s,p] * Capacity[g]

**Equation 7**

This equation illustrates the **minimum level of fleetwide capacity** that needs to be maintained. It shows the **total avaliable generation capacity must be equal or greater than the target value**. It specifies that there must be enough capacity in the system to meet the target. 

The target could represent a **proxy** for various considerations, which could include capacity, spinning reserves and load shape in the system.  

.. code-block:: ampl

    sum {g} Cap[g,y,s,p] >= Target[y,s,p] / Phi[s,p]

**Equation 8**

This equation defines the **cumulative retirement** in each year. 

.. code-block:: ampl

    RetireC[g,y,s,p] = sum {y_prime in Years: y_prime <= y} Retire[g,y_prime,s,p]
